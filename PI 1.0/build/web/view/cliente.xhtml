<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:composition template="template.xhtml">
        <ui:define name="centro">
            <p:panel header="Consulta de Cliente" style="text-align: center; border: 0px"><br/>


                <!-- Dialog e cadastro de usuario -->

                <div align="right">

                    <h:form>
                        <h:panelGrid columns="3">  
                            <p:inputText id="keyword" value="#{watermarkBean.keyword}" required="true" label="Keyword" />  
                            <p:watermark for="keyword" value="Nome do Cliente" />  
                            <p:commandButton actionListener="#{watermarkBean.search}" value="Pesquisar" ajax="false" /> 
                        </h:panelGrid>  
                    </h:form>
                    <br/>

                    <p:commandButton id="showDialogButton" type="button" value="Incluir Novo Cliente"  icon="ui-icon-plus" onclick="dlg.show();" />

                    <p:dialog header="Cadasto novo Cliente" widgetVar="dlg" resizable="false">  
                        <h:form id="form">  
                            <h:panelGrid columns="2" style="margin-bottom:10px">  
                                <h:outputLabel value="Nome:" />  
                                <p:inputText style="width: 250px" id="name" value="#{clienteMB.cliente.nome}" />  

                                <h:outputLabel  value="CPF:" />  
                                <p:inputText style="width: 150px" id="cpf" value="#{clienteMB.cliente.cpf}" />  

                                <h:outputLabel value="RG:" />  
                                <p:inputText id="rg" style="width: 150px" value="#{clienteMB.cliente.rg}" />  

                                <h:outputLabel value="Estado: " />  
                                <p:inputText value="#{clienteMB.cliente.estado}"/>  

                                <h:outputLabel  value="Cidade:" />  
                                <p:inputText id="cidade" style="width: 100px" value="#{clienteMB.cliente.cidade}" />
                            </h:panelGrid>  

                            <h:commandButton id="submitButton" value="Cadastrar"  actionListener="#{clienteMB.cadastrarCliente()}" />  
                        </h:form>  
                    </p:dialog>  
                </div><br/>

                <h:form>
                    <p:dataTable id="tabela"     value="#{clienteMB.listar()}" var="cliente">
                        <p:column headerText="Nome">
                            <h:outputText value="#{cliente.nome}"/>
                        </p:column>

                        <p:column headerText="CPF">
                            <h:outputText value="#{cliente.cpf}"/>
                        </p:column>

                        <p:column headerText="RG">
                            <h:outputText value="#{cliente.rg}"/>
                        </p:column>

                        <p:column headerText="Estado">  
                            <h:outputText value="#{cliente.estado}"/>
                        </p:column>

                        <p:column headerText="Cidade">
                            <h:outputText value="#{cliente.cidade}"/>
                        </p:column>

                        <p:column headerText="Opções">
                            <p:commandButton icon="ui-icon-pencil" title="Editar" update="tabela" onclick="dlgEditar.show();">
                                <f:setPropertyActionListener target="#{clienteMB.clienteSelecionado}" value="#{cliente}"/>
                            </p:commandButton>

                            <p:commandButton  icon="ui-icon-trash" title="Apagar" ajax="false" update="tabela" actionListener="#{clienteMB.deletarCliente(cliente)}"/>
                            <h:outputLink value="conta.xhtml">
                                <p:button icon="ui-icon-clipboard" title="Abrir conta"/>
                            </h:outputLink>
                        </p:column>

                    </p:dataTable>
                </h:form>

                <!--                    Dialog editar cliente-->
                <p:dialog widgetVar="dlgEditar" header="Editar Cliente" resizable="false" closable="false">
                    <h:form>
                        <p:panelGrid columns="2" style="margin-bottom:10px" >
                            <h:outputText value="Nome"/>
                            <p:inputText   value="#{clienteMB.clienteSelecionado.nome}"/>

                            <h:outputText value="CPF"/>
                            <p:inputText  value="#{clienteMB.clienteSelecionado.cpf}"/>

                            <h:outputText value="RG"/>
                            <p:inputText  value="#{clienteMB.clienteSelecionado.rg}"/>

                            <h:outputText value="Estado: " />  
                            <p:inputText value="#{clienteMB.clienteSelecionado.estado}"/>  


                            <h:outputText value="Cidade"/>
                            <p:inputText  value="#{clienteMB.clienteSelecionado.cidade}"/>

                        </p:panelGrid>
                        <h:commandButton value="Salvar" actionListener="#{clienteMB.alterarCliente()}" />
                        <h:commandButton value="Cancelar" onclick="dlgEditar.hide();"/>
                    </h:form>
                </p:dialog>

            </p:panel>
        </ui:define>
    </ui:composition>
</html>
